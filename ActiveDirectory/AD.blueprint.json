{"status":{},"product_version":"2.7.0","spec":{"description":"","resources":{"client_attrs":{"1bd2d70a_deployment":{"y":88,"x":501}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e8ae6024_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"170603f6_runbook","main_task_local_reference":{"kind":"app_task","name":"e8ae6024_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"f25e9ca6_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"017e6fe9_runbook","main_task_local_reference":{"kind":"app_task","name":"f25e9ca6_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"7cd4b387_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"73434119_runbook","main_task_local_reference":{"kind":"app_task","name":"7cd4b387_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"83f2a218_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"35799808_runbook","main_task_local_reference":{"kind":"app_task","name":"83f2a218_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"7078cac1_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0d16f818_runbook","main_task_local_reference":{"kind":"app_task","name":"7078cac1_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"Active_Directory","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"ActiveDirectory"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"c439f5e7_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"d1d02e7c_runbook","main_task_local_reference":{"kind":"app_task","name":"c439f5e7_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"ActiveDirectory"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"23aa1f39_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"3169354b_runbook","main_task_local_reference":{"kind":"app_task","name":"23aa1f39_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"AHV_VM","name":"ActiveDirectory","readiness_probe":{"connection_type":"POWERSHELL","retries":"5","disable_readiness_probe":false,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","connection_port":5985,"login_credential_local_reference":{"kind":"app_credential","name":"LOCAL"}},"editables":{"readiness_probe":{"connection_type":true,"delay_secs":true,"connection_port":true,"timeout_secs":true},"create_spec":{"name":true,"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"guest_customization":true,"disk_list":{}}}},"os_type":"Windows","create_spec":{"name":"DND-AD","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[{"ip":"@@{STATIC_IP}@@","type":"ASSIGNED"}],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"15d53994-8dc0-460f-a883-73e50f0c79a4"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"gpu_list":[],"memory_size_mib":4096,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":null,"type":"","sysprep":{"install_type":"PREPARED","unattend_xml":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-TCPIP\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <Interfaces>\n            <Interface wcm:action=\"add\">\n               <Identifier>Ethernet<\/Identifier>\n               <Ipv4Settings>\n                  <DhcpEnabled>false<\/DhcpEnabled>\n                  <RouterDiscoveryEnabled>true<\/RouterDiscoveryEnabled>\n                  <Metric>30<\/Metric>\n               <\/Ipv4Settings>\n               <UnicastIpAddresses>\n                  <IpAddress wcm:action=\"add\" wcm:keyValue=\"1\">@@{STATIC_IP}@@\/@@{PREFIX}@@<\/IpAddress>\n               <\/UnicastIpAddresses>\n               <Routes>\n                  <Route wcm:action=\"add\">\n                     <Identifier>10<\/Identifier>\n                     <Metric>20<\/Metric>\n                     <NextHopAddress>@@{GATEWAY}@@<\/NextHopAddress>\n                     <Prefix>0.0.0.0\/0<\/Prefix>\n                  <\/Route>\n               <\/Routes>\n            <\/Interface>\n         <\/Interfaces>\n      <\/component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false<\/fDenyTSConnections>\n      <\/component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0<\/UserAuthentication>\n      <\/component>\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true<\/Active>\n               <Profile>all<\/Profile>\n               <Group>@FirewallAPI.dll,-28752<\/Group>\n            <\/FirewallGroup>\n         <\/FirewallGroups>\n      <\/component>\n   <\/settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>@@{LOCAL.secret}@@<\/Value>\n               <PlainText>true<\/PlainText>\n            <\/AdministratorPassword>\n         <\/UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>@@{LOCAL.secret}@@<\/Value>\n               <PlainText>true<\/PlainText>\n            <\/Password>\n            <Enabled>true<\/Enabled>\n            <Username>Administrator<\/Username>\n         <\/AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe \/c netsh firewall add portopening TCP 5985 \"Port 5985\"<\/CommandLine>\n               <Description>Win RM port open<\/Description>\n               <Order>1<\/Order>\n               <RequiresUserInput>true<\/RequiresUserInput>\n            <\/SynchronousCommand>\n         <\/FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true<\/HideEULAPage>\n            <SkipMachineOOBE>true<\/SkipMachineOOBE>\n         <\/OOBE>\n      <\/component>\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US<\/InputLocale>\n         <SystemLocale>en-US<\/SystemLocale>\n         <UILanguageFallback>en-us<\/UILanguageFallback>\n         <UILanguage>en-US<\/UILanguage>\n         <UserLocale>en-US<\/UserLocale>\n      <\/component>\n   <\/settings>\n<\/unattend>","type":""}},"power_state":"ON","type":"","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"WindowsServer2016-Base","uuid":"a78e4dab-bf21-4ce2-aca6-8a23793c9edc"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"administrator","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"LOCAL","editables":{"username":true,"secret":true}},{"username":"administrator@contoso.com","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"DOMAIN_CRED","editables":{"username":true,"secret":true}}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"Active_Directory"}],"name":"Active_Directory_Package","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Active_Directory_Package"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"Set Hostname"},{"kind":"app_task","name":"Wait for VM to Restart"},{"kind":"app_task","name":"Install AD"},{"kind":"app_task","name":"Wait for VM to Install AD"},{"kind":"app_task","name":"Open Firewall Ports"}],"name":"80dbbb84_dag","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Set Hostname"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Wait for VM to Restart"}},{"from_task_reference":{"kind":"app_task","name":"Wait for VM to Restart"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Install AD"}},{"from_task_reference":{"kind":"app_task","name":"Install AD"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Wait for VM to Install AD"}},{"from_task_reference":{"kind":"app_task","name":"Wait for VM to Install AD"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Open Firewall Ports"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_package","name":"Active_Directory_Package"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Set Hostname","state":"ACTIVE","attrs":{"exit_status":[],"script":"##############################################\n# Name        : JoinDomain.ps1\n# Author      : K Sarat Kumar\n# Version     : 1.0\n# Description : Script is join to domain in case of CDC, ADC & RODC.\n##############################################\nEnable-WSManCredSSP -Role Server -Force\nfunction JointoDomain {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$false)]\n      [string]$OU,\n      [parameter(Mandatory=$true)]\n      [string]$Username,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$true)]\n      [string]$Server\n  )\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses $Server\n\n  if ($env:computername  -eq $env:userdomain) {\n    Write-Output \"Not in domain\"\n    $adminname = $Username\n    $adminpassword = ConvertTo-SecureString -asPlainText -Force -String \"$Password\"\n    Write-Output \"$adminname , $password\"\n    $credential = New-Object System.Management.Automation.PSCredential($adminname,$adminpassword)\n    Add-computer -DomainName $DomainName -Credential $credential -force -Options JoinWithNewName,AccountCreate -PassThru -ErrorAction Stop\n  }\n  else {\n     Write-Output \"Already in domain\"\n  }\n}\n\nif(\"@@{DOMAIN_TYPE}@@\" -eq \"DC\"){\n  $adapter = Get-NetAdapter | ? {$_.Status -eq \"up\"}\n  $adapter | Set-DnsClientServerAddress -ServerAddresses \"127.0.0.1\"\n  Restart-Computer -Force -AsJob\n  exit 0\n}\nif( (\"@@{PARENT_IP}@@\" -eq \"\") -or (\"@@{DOMAIN}@@\" -eq \"\") -or (\"@@{DOMAIN_CRED.secret}@@\" -eq \"\")){\n\tWrite-Output \"Please pass all mandatory variables DOMAIN,PARENT_IP & CREDS\"\n    exit 1\n}\nJointoDomain -DomainName \"@@{DOMAIN}@@\" -Username \"@@{DOMAIN_CRED.username}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -Server \"@@{PARENT_IP}@@\"\nStart-Sleep 3\n\nRestart-Computer -Force -AsJob\nexit 0","script_type":"npsscript","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"LOCAL"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Wait for VM to Restart","state":"ACTIVE","attrs":{"script":"#script\nsleep(50)","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Install AD","state":"ACTIVE","attrs":{"exit_status":[],"script":"##############################################\n# Name        : ActiveDirectoryBundle.ps1\n# Author      : K Sarath Kumar\n# Version     : 1.0\n# Description : Installs and configures domain controller features AD, CDC, ADC & RODC.\n##############################################\n\n$WS2008R2_MAJOR                 = '6.1'\n$WS2012_MAJOR                   = '6.2'\n$WS2012R2_MAJOR                 = '6.3'\n$WS2016_MAJOR                   = '10.0'\n\n# -*- Checks AD Domain services Installation\nfunction Check-ActiveDirectoryFeature {\n   return $(Get-WindowsFeature AD-Domain-Services -ErrorAction SilentlyContinue).Installed\n}\n# -*- Installs AD Domain services\nfunction Install-ActiveDirectory {\n  Write-Output \"Installing AD Features.\"\n  Install-WindowsFeature -Name AD-Domain-Services -IncludeManagementTools\n}\n# -*- Checks the pre existance of domain\nfunction Check-DomainExistance {\n  #if (Get-ADDomainController -Discover -ErrorAction SilentlyContinue){\n  if (\"$((wmic ComputerSystem get DomainRole)[2])\".trim() -eq \"5\"){\n   return $true\n  } else{\n    return $false\n  }\n}\n\n# -*- Configures AD Domain service\nfunction Configure-ActiveDirectory {\n  [CmdletBinding()]\n  Param(\n      [parameter(Mandatory=$true)]\n      [string]$DomainName,\n      [parameter(Mandatory=$true)]\n      [string]$Password,\n      [parameter(Mandatory=$false)]\n      [string]$DatabasePath=\"C:\\Windows\\NTDS\",\n      [parameter(Mandatory=$true)]\n      [string]$DomainMode,\n      [parameter(Mandatory=$true)]\n      [string]$ForestMode,\n      [parameter(Mandatory=$false)]\n      [string]$LogPath=\"C:\\Windows\\NTDS\",\n      [parameter(Mandatory=$false)]\n      [string]$SysvolPath=\"C:\\Windows\\SYSVOL\",\n      [parameter(Mandatory=$true)]\n      [string]$DomainType,\n      [parameter(Mandatory=$false)]\n      [string]$ChildDomainName\n  )\n  Import-Module ADDSDeployment\n\n  $secpasswd = ConvertTo-SecureString $Password -AsPlainText -Force\n  $credential = New-Object System.Management.Automation.PSCredential(\"$DomainName\\administrator\",$secpasswd)\n  $netbios = $DomainName.Split(\".\")[0].ToUpper()\n  Write-Output \"Configuring Domain services.\"\n  switch ($DomainType){\n    \"DC\"{\n      Install-ADDSForest -CreateDnsDelegation:$false -DatabasePath $DatabasePath -DomainMode $DomainMode -DomainName $DomainName -DomainNetbiosName $netbios -ForestMode $ForestMode -InstallDns:$true -LogPath $LogPath -NoRebootOnCompletion:$true -SysvolPath $SysvolPath -Force:$true -SafeModeAdministratorPassword $secpasswd\n    }\n    \"ADC\"{\n      Install-ADDSDomainController -NoGlobalCatalog:$false -CreateDnsDelegation:$false -CriticalReplicationOnly:$false -DatabasePath $DatabasePath -DomainName $DomainName -InstallDns:$true -LogPath $LogPath -NoRebootOnCompletion:$true -SiteName \"Default-First-Site-Name\" -SysvolPath $SysvolPath -Force:$true -SafeModeAdministratorPassword $secpasswd -Credential $credential\n    }\n    \"CDC\"{\n      Install-ADDSDomain -NoGlobalCatalog:$false -CreateDnsDelegation:$true -DatabasePath $DatabasePath -DomainMode $DomainMode -DomainType \"ChildDomain\" -InstallDns:$true -LogPath $LogPath -NewDomainName $ChildDomainName -NewDomainNetbiosName $ChildDomainName.ToUpper() -ParentDomainName $DomainName -NoRebootOnCompletion:$true -SiteName \"Default-First-Site-Name\" -SysvolPath $SysvolPath -Force:$true -SafeModeAdministratorPassword $secpasswd -Credential $credential\n    }\n    \"RODC\"{\n      Install-ADDSDomainController -AllowPasswordReplicationAccountName @(\"$netbios\\Allowed RODC Password Replication Group\") -NoGlobalCatalog:$false -CriticalReplicationOnly:$false -DatabasePath $DatabasePath -DenyPasswordReplicationAccountName @(\"BUILTIN\\Administrators\", \"BUILTIN\\Server Operators\", \"BUILTIN\\Backup Operators\", \"BUILTIN\\Account Operators\", \"$netbios\\Denied RODC Password Replication Group\") -DomainName $DomainName -InstallDns:$true -LogPath $LogPath -NoRebootOnCompletion:$true -ReadOnlyReplica:$true -SiteName \"Default-First-Site-Name\" -SysvolPath $SysvolPath -Force:$true -SafeModeAdministratorPassword $secpasswd -Credential $credential\n    }\n    default{\n      Write-Output \"Invalid DomainType\"\n    }\n}\n}\n# -*- Cheking Exitance of Active directory Feature.\nif (Check-ActiveDirectoryFeature){\n  Write-Output \"Active Directory already installed.\"\n} else{\n  Install-ActiveDirectory\n}\n\nif (Check-DomainExistance){\n  Write-Output \"Domain exists already.\"\n} else{\n  $MajorOSVersion= [string](Get-WmiObject Win32_OperatingSystem | Select-Object @{n=\"Major\";e={($_.Version.Split(\".\")[0]+\".\"+$_.Version.Split(\".\")[1])}}).Major\n  if ($MajorOSVersion -eq $WS2012R2_MAJOR){\n    $DomainMode = \"Win2012R2\"\n  } elseif ($MajorOSVersion -eq $WS2016_MAJOR){\n    $DomainMode = \"WinThreshold\"\n  }\n  Configure-ActiveDirectory -DomainName \"@@{DOMAIN}@@\" -Password \"@@{DOMAIN_CRED.secret}@@\" -DomainMode $DomainMode -ForestMode $DomainMode -DomainType \"@@{DOMAIN_TYPE}@@\" -ChildDomainName \"@@{CHILD_DOMAIN}@@\"\n}\n\nStart-Sleep 2\n\nRestart-Computer -Force -AsJob\nexit 0","script_type":"npsscript","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"LOCAL"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Wait for VM to Install AD","state":"ACTIVE","attrs":{"script":"#script\nsleep(90)","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"Active_Directory"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"Open Firewall Ports","state":"ACTIVE","attrs":{"exit_status":[],"script":"New-NetFirewallRule -DisplayName \"AD\" -Direction Inbound -Protocol UDP -LocalPort 389 -Action allow\nNew-NetFirewallRule -DisplayName \"DNS TCP\" -Direction Inbound -Protocol TCP -LocalPort 53 -Action allow\nNew-NetFirewallRule -DisplayName \"DNS UDP\" -Direction Inbound -Protocol UDP -LocalPort 53 -Action allow\nNew-NetFirewallRule -DisplayName \"GC TCP\" -Direction Inbound -Protocol TCP -LocalPort 3268 -Action allow\nNew-NetFirewallRule -DisplayName \"GC UDP\" -Direction Inbound -Protocol UDP -LocalPort 3269 -Action allow\nNew-NetFirewallRule -DisplayName \"SYSVOL TCP\" -Direction Inbound -Protocol TCP -LocalPort 139 -Action allow\nNew-NetFirewallRule -DisplayName \"SYSVOL UDP\" -Direction Inbound -Protocol UDP -LocalPort 138 -Action allow\nNew-NetFirewallRule -DisplayName \"KERBROS UDP\" -Direction Inbound -Protocol UDP -LocalPort 88 -Action allow\nNew-NetFirewallRule -DisplayName \"AD COM TCP\" -Direction Inbound -Protocol TCP -LocalPort 135 -Action allow\nNew-NetFirewallRule -DisplayName \"AD COM UDP\" -Direction Inbound -Protocol UDP -LocalPort 135 -Action allow\nNew-NetFirewallRule -DisplayName \"KERBROS PW CHANGE TCP\" -Direction Inbound -Protocol TCP -LocalPort 464 -Action allow\nNew-NetFirewallRule -DisplayName \"KERBROS PW CHANGE UDP\" -Direction Inbound -Protocol UDP -LocalPort 464 -Action allow","script_type":"npsscript","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"LOCAL"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"5c108f0d_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"80dbbb84_dag"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Active_Directory_Package"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"6f292b4a_dag","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"1f35f88e_runbook","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"6f292b4a_dag"},"message_list":[],"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"depends_on_list":[],"name":"1bd2d70a_deployment","published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Active_Directory_Package"}],"substrate_local_reference":{"kind":"app_substrate","name":"ActiveDirectory"},"min_replicas":"1","variable_list":[],"description":""}],"description":"","action_list":[],"name":"Nutanix","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DOMAIN","value":"contoso.com","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DOMAIN_TYPE","value":"DC","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"PARENT_IP","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"CHILD_DOMAIN","value":"","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"STATIC_IP","value":"10.46.6.5","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"GATEWAY","value":"10.46.6.1","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"PREFIX","value":"24","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"LOCAL"},"type":"USER"},"name":"AD"},"api_version":"3.0","metadata":{"last_update_time":"1566968010019655","kind":"blueprint","spec_version":7,"creation_time":"1560763605997026","name":"AD"}}