{"api_version":"3.0","metadata":{"creation_time":"1544211059201551","kind":"blueprint","last_update_time":"1544469403994965","name":"NutanixCloudNativeWithDatabaseProvisioning","spec_version":14},"spec":{"description":"","name":"NutanixCloudNativeWithDatabaseProvisioning","resources":{"app_profile_list":[{"action_list":[],"deployment_create_list":[{"action_list":[],"depends_on_list":[],"description":"","max_replicas":"100","min_replicas":"3","name":"2a8a15a6_deployment","options":{"metadata":{"labels":{"app":"django","component":"oscar","tier":"frontend"},"name":"oscar-django-deployment","namespace":"@@{kube_namespace}@@"},"spec":{"replicas":3,"selector":{"matchLabels":{"app":"django"}}},"type":"PROVISION_K8S_DEPLOYMENT"},"package_local_reference_list":[{"kind":"app_package","name":"Package3"}],"published_service_local_reference_list":[{"kind":"app_published_service","name":"K8sPublishedService"}],"substrate_local_reference":{"kind":"app_substrate","name":"Oscar"},"type":"K8S_DEPLOYMENT","variable_list":[]},{"action_list":[],"depends_on_list":[],"description":"","max_replicas":"1","min_replicas":"1","name":"53643d97_deployment","package_local_reference_list":[{"kind":"app_package","name":"Package4"}],"published_service_local_reference_list":[],"substrate_local_reference":{"kind":"app_substrate","name":"Object_Storage_Bucket"},"type":"GREENFIELD","variable_list":[]},{"action_list":[],"depends_on_list":[],"description":"","max_replicas":"1","min_replicas":"1","name":"f6be2786_deployment","package_local_reference_list":[{"kind":"app_package","name":"Package2"}],"published_service_local_reference_list":[],"substrate_local_reference":{"kind":"app_substrate","name":"Era_PostgreSQL_DB"},"type":"GREENFIELD","variable_list":[]},{"action_list":[],"depends_on_list":[],"description":"","max_replicas":"1","min_replicas":"1","name":"f9a4c530_deployment","package_local_reference_list":[{"kind":"app_package","name":"EraPackage"}],"published_service_local_reference_list":[],"substrate_local_reference":{"kind":"app_substrate","name":"EraServer"},"type":"GREENFIELD","variable_list":[]}],"description":"","name":"Default","variable_list":[{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"buckets_ip","type":"LOCAL","val_type":"STRING","value":"10.20.132.116"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"buckets_name","type":"LOCAL","val_type":"STRING","value":"oscarstatic"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"compute_profile","type":"LOCAL","val_type":"STRING","value":"DEFAULT_OOB_COMPUTE"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"database_parameter","type":"LOCAL","val_type":"STRING","value":"DEFAULT_POSTGRES_PARAMS"},{"description":"","editables":{"value":true},"label":"","name":"db_name_prefix","type":"LOCAL","val_type":"STRING","value":"oscar_django"},{"attrs":{"is_secret_modified":false,"secret_reference":{},"type":""},"description":"","editables":{"value":true},"label":"","name":"db_password","type":"SECRET","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"db_public_key","type":"LOCAL","val_type":"STRING","value":"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDUm18acWv344TgOXBuOnozuSXytDuqKFVE0+x7CK\/dZ6Y331lBF+f8AE\/Ng3tzxvCDUeth3pa7XO\/Y95zc+hTLGROBmWdgidfykBi2FeQ6hZOcsUDslPUL3Ig8UpPzbOva276YP3266+1BGjLi14neBSJvpSV2DvXQovMb57mhAWs9BlVj3UIviHBMQYXc9RUiyoTBYphqQi5THsQafEFEA+3EJ\/NLhqF4CTRZoxMk+VDZbQCCYk0SNEDvDnhEUCIQW1KDg8HDaHrCcRE8DKwi1dgDjASwcUeDuaFto0WrUaj8FdOvaIwjLKYC9DUgsPel+FOLNkg0cPi0vuXb1CGZ era@domain.com"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"era_ip","type":"LOCAL","val_type":"STRING","value":"10.20.132.115"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"kube_namespace","type":"LOCAL","val_type":"STRING","value":"cloudnative"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"kubemaster_ip","type":"LOCAL","val_type":"STRING","value":"10.20.140.157"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"network_profile","type":"LOCAL","val_type":"STRING","value":"DEFAULT_OOB_NETWORK"},{"attrs":{"type":""},"description":"","editables":{"value":true},"label":"","name":"sla_name","type":"LOCAL","val_type":"STRING","value":"GOLD"},{"description":"","editables":{"value":true},"label":"","name":"software_profile","type":"LOCAL","val_type":"STRING","value":"POSTGRES_10.4_OOB"}]}],"client_attrs":{"0b7c2f7d-f5f8-f9a1-6ad3-ca3cff2ee70a":{"x":658.75,"y":443},"2a8a15a6_deployment":{"x":1077.1171875,"y":377.9999847412},"53643d97_deployment":{"x":594.30859375,"y":644.9999923706},"c3f347d9-1f86-5e3b-f2f5-9d709b2fecc1":{"x":830.1171875,"y":479.9999847412},"f6be2786_deployment":{"x":765.75,"y":229},"f9a4c530_deployment":{"x":479,"y":143}},"credential_definition_list":[{"description":"","name":"buckets_creds","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"type":"PASSWORD","username":"poseidon_access"},{"description":"","name":"db_server_creds","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"type":"KEY","username":"era"},{"description":"","name":"era_creds","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"type":"PASSWORD","username":"admin"},{"description":"","name":"kube_creds","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"type":"PASSWORD","username":"admin"}],"default_credential_local_reference":{"kind":"app_credential","name":"era_creds"},"package_definition_list":[{"action_list":[],"description":"","name":"EraPackage","options":{"install_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"7bd63f34_dag"},"message_list":[],"name":"a56589a3_runbook","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"GetClusterID"},"to_task_reference":{"kind":"app_task","name":"GetProfileIDs"},"type":""},{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"GetProfileIDs"},"to_task_reference":{"kind":"app_task","name":"GetSLAID"},"type":""},{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"GetSLAID"},"to_task_reference":{"kind":"app_task","name":"ProvisionDB"},"type":""},{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"MonitorOperation"},"to_task_reference":{"kind":"app_task","name":"GetDatabaseInfo"},"type":""},{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"ProvisionDB"},"to_task_reference":{"kind":"app_task","name":"MonitorOperation"},"type":""}],"type":""},"child_tasks_local_reference_list":[{"kind":"app_task","name":"GetClusterID"},{"kind":"app_task","name":"GetDatabaseInfo"},{"kind":"app_task","name":"GetProfileIDs"},{"kind":"app_task","name":"GetSLAID"},{"kind":"app_task","name":"MonitorOperation"},{"kind":"app_task","name":"ProvisionDB"}],"description":"","message_list":[],"name":"7bd63f34_dag","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"EraPackage"},"timeout_secs":"0","type":"DAG","variable_list":[]},{"attrs":{"eval_scope":"local","eval_variables":["CLUSTER_ID"],"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Cluster ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/clusters\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"CLUSTER_ID={0}\".format(json.loads(resp.content)[0]['id'])","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"GetClusterID","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"attrs":{"eval_scope":"local","eval_variables":["DB_ID","DB_SERVER_ID","DB_SERVER_IP"],"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get DB Server IP and ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/databases\/name\/@@{DB_ENTITY_NAME}@@?detailed=true\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"DB_SERVER_IP={0}\".format(json.loads(resp.content)['hostIP'])\nprint \"DB_ID={0}\".format(json.loads(resp.content)['id'])\nprint \"DB_SERVER_ID={0}\".format(json.loads(resp.content)['primaryHost'])","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"GetDatabaseInfo","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"attrs":{"eval_scope":"local","eval_variables":["COMPUTE_PROF_ID","DB_PARAM_ID","NETWORK_PROF_ID","SOFTWARE_PROF_ID"],"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Get Software Profile ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/profiles?type=Software&name=@@{software_profile}@@\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"SOFTWARE_PROF_ID={0}\".format(json.loads(resp.content)['id'])\n\n# Get Compute Profile ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/profiles?type=Compute&name=@@{compute_profile}@@\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"COMPUTE_PROF_ID={0}\".format(json.loads(resp.content)['id'])\n\n# Get Compute Profile ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/profiles?type=Network&name=@@{network_profile}@@\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"NETWORK_PROF_ID={0}\".format(json.loads(resp.content)['id'])\n\n# Get Compute Profile ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/profiles?type=Database_Parameter&name=@@{database_parameter}@@\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"DB_PARAM_ID={0}\".format(json.loads(resp.content)['id'])","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"GetProfileIDs","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"attrs":{"eval_scope":"local","eval_variables":["DB_NAME","SLA_ID"],"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Set the db_name here, so we don't have the calm_time macro expanding at two different times\nprint \"DB_NAME=@@{db_name_prefix}@@_{0}\".format(@@{calm_time(\"%Y%m%d%H%M\")}@@)\n\n# Get the list of SLAs\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/slas\"\nresp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n\n# Find the desired SLA, and set the corresponding ID to the variable\nfor sla in json.loads(resp.content):\n  if sla['name'] == \"@@{sla_name}@@\":\n    print \"SLA_ID={0}\".format(sla['id'])","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"GetSLAID","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"attrs":{"eval_scope":"local","eval_variables":["DB_ENTITY_NAME"],"exit_status":[],"script":"# Set creds, headers, and URL\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/operations\/@@{CREATE_OPERATION_ID}@@\"\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 60 seconds.\"\n  sleep(60)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  print \"Percentage Complete: {0}\".format(json.loads(resp.content)['percentageComplete'])\n  \n  # If complete, break out of loop\n  if json.loads(resp.content)['percentageComplete'] == \"100\":\n    break    \n\n# If the operation did not complete within 20 minutes, assume it's not successful and error out\nif json.loads(resp.content)['percentageComplete'] != \"100\":\n  exit(1)\n\n# Get the newly provision DB Entity Name and set it to a variable\nprint \"DB_ENTITY_NAME={0}\".format(json.loads(resp.content)['entityName'])","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"MonitorOperation","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"attrs":{"eval_scope":"local","eval_variables":["CREATE_OPERATION_ID"],"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Set the URL and payload\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/databases\/provision\"\npayload = {\n  \"databaseName\": \"@@{DB_NAME}@@\",\n  \"databaseType\": \"postgres_database\",\n  \"databaseDescription\": \"Postgres database provisioned by Calm Application @@{calm_application_name}@@\",\n  \"clusterId\": \"@@{CLUSTER_ID}@@\",\n  \"softwareProfileId\": \"@@{SOFTWARE_PROF_ID}@@\",\n  \"computeProfileId\": \"@@{COMPUTE_PROF_ID}@@\",\n  \"networkProfileId\": \"@@{NETWORK_PROF_ID}@@\",\n  \"dbParameterProfileId\": \"@@{DB_PARAM_ID}@@\",\n  \"provisionInfo\": [\n    {\n      \"name\": \"application_type\",\n      \"value\": \"postgres_database\"\n    },\n    {\n      \"name\": \"listener_port\",\n      \"value\": \"5432\"\n    },\n    {\n      \"name\": \"database_size\",\n      \"value\": \"200\"\n    },\n    {\n      \"name\": \"working_dir\",\n      \"value\": \"\/tmp\"\n    },\n    {\n      \"name\": \"auto_tune_staging_drive\",\n      \"value\": True\n    },\n    {\n      \"name\": \"db_password\",\n      \"value\": \"@@{db_password}@@\"\n    },\n    {\n      \"name\": \"dbserver_name\",\n      \"value\": \"PostgreSQL-@@{calm_time}@@\"\n    },\n    {\n      \"name\": \"dbserver_description\",\n      \"value\": \"Postgres database server provisioned by Calm Application @@{calm_application_name}@@\"\n    },\n    {\n      \"name\": \"ssh_public_key\",\n      \"value\": \"@@{db_public_key}@@\"\n    }\n  ],\n  \"timeMachineInfo\": {\n    \"name\": \"PostgreSQL-@@{calm_time}@@_TM\",\n    \"description\": \"PostgreSQL-@@{calm_time}@@ time machine\",\n    \"slaId\": \"@@{SLA_ID}@@\",\n    \"schedule\": {\n      \"continuousSchedule\": {\n        \"enabled\": True,\n        \"logBackupInterval\": 30,\n        \"snapshotsPerDay\": 30\n      },\n      \"snapshotTimeOfDay\": {\n        \"hours\": 1,\n        \"minutes\": 0,\n        \"seconds\": 0\n      },\n      \"weeklySchedule\": {\n        \"enabled\": True,\n        \"dayOfWeek\": \"SUNDAY\"\n      },\n      \"monthlySchedule\": {\n        \"enabled\": True,\n        \"dayOfMonth\": 1\n      },\n      \"quartelySchedule\": {\n        \"enabled\": True,\n        \"startMonth\": \"JANUARY\",\n        \"dayOfMonth\": 1\n      },\n      \"yearlySchedule\": {\n        \"enabled\": False,\n        \"month\": \"DECEMBER\",\n        \"dayOfMonth\": 1\n      }\n    }\n  }\n}\n\n# Make the call and set the response operation ID to the variable\nresp = urlreq(url, verb='POST', auth='BASIC', user=era_user, passwd=era_pass, params=json.dumps(payload), headers=headers)\nprint \"CREATE_OPERATION_ID={0}\".format(json.loads(resp.content)['operationId'])","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"ProvisionDB","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]}],"variable_list":[]},"type":"","uninstall_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"99b487fd_dag"},"message_list":[],"name":"a8f36ab1_runbook","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"CleanupDB"},"to_task_reference":{"kind":"app_task","name":"MonitorCleanupOp"},"type":""},{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"DeregisterDBServer"},"to_task_reference":{"kind":"app_task","name":"MonitorDeregOp"},"type":""},{"edge_type":"user_defined","from_task_reference":{"kind":"app_task","name":"MonitorCleanupOp"},"to_task_reference":{"kind":"app_task","name":"DeregisterDBServer"},"type":""}],"type":""},"child_tasks_local_reference_list":[{"kind":"app_task","name":"CleanupDB"},{"kind":"app_task","name":"DeregisterDBServer"},{"kind":"app_task","name":"MonitorCleanupOp"},{"kind":"app_task","name":"MonitorDeregOp"}],"description":"","message_list":[],"name":"99b487fd_dag","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"EraPackage"},"timeout_secs":"0","type":"DAG","variable_list":[]},{"attrs":{"eval_scope":"local","eval_variables":["CLEANUP_OPERATION_ID"],"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Cleanup the DB and get Operation ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/databases\/@@{DB_ID}@@?storage-cleanup=true&tm-cleanup=true\"\nresp = urlreq(url, verb='DELETE', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"CLEANUP_OPERATION_ID={0}\".format(json.loads(resp.content)['operationId'])","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"CleanupDB","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"attrs":{"eval_scope":"local","eval_variables":["DEREGISTER_OPERATION_ID"],"exit_status":[],"script":"# Set creds and headers\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\n# Cleanup the DB and get Operation ID\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/dbservers\/@@{DB_SERVER_ID}@@?cleanup=true&storage-cleanup=true\"\nresp = urlreq(url, verb='DELETE', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\nprint \"DEREGISTER_OPERATION_ID={0}\".format(json.loads(resp.content)['operationId'])","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"DeregisterDBServer","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"script":"# Set creds, headers, and URL\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/operations\/@@{CLEANUP_OPERATION_ID}@@\"\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 30 seconds.\"\n  sleep(30)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  print \"Percentage Complete: {0}\".format(json.loads(resp.content)['percentageComplete'])\n  \n  # If complete, break out of loop\n  if json.loads(resp.content)['percentageComplete'] == \"100\":\n    break    \n\n# If the operation did not complete within 10 minutes, assume it's not successful and error out\nif json.loads(resp.content)['percentageComplete'] != \"100\":\n  exit(1)","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"MonitorCleanupOp","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"script":"# Set creds, headers, and URL\nera_user = '@@{era_creds.username}@@'\nera_pass = '@@{era_creds.secret}@@'\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\nurl     = \"https:\/\/@@{era_ip}@@:8443\/era\/v0.8\/operations\/@@{DEREGISTER_OPERATION_ID}@@\"\n\n# Monitor the operation\nfor x in range(20):\n  \n  print \"Sleeping for 30 seconds.\"\n  sleep(30)\n  resp = urlreq(url, verb='GET', auth='BASIC', user=era_user, passwd=era_pass, headers=headers)\n  print \"Percentage Complete: {0}\".format(json.loads(resp.content)['percentageComplete'])\n  \n  # If complete, break out of loop\n  if json.loads(resp.content)['percentageComplete'] == \"100\":\n    break    \n\n# If the operation did not complete within 10 minutes, assume it's not successful and error out\nif json.loads(resp.content)['percentageComplete'] != \"100\":\n  exit(1)","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"MonitorDeregOp","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"variable_list":[]}},"service_local_reference_list":[{"kind":"app_service","name":"Era"}],"type":"DEB","variable_list":[],"version":""},{"action_list":[],"description":"","name":"Package2","options":{"install_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"58ca4a03_dag"},"message_list":[],"name":"8b1f1a7b_runbook","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[{"kind":"app_task","name":"CreateMigration"}],"description":"","message_list":[],"name":"58ca4a03_dag","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package2"},"timeout_secs":"0","type":"DAG","variable_list":[]},{"attrs":{"command_line_args":"","exit_status":[],"script":"url     = \"https:\/\/@@{kubemaster_ip}@@:443\/apis\/batch\/v1\/namespaces\/@@{kube_namespace}@@\/jobs\"\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\npayload = {\n  \"apiVersion\": \"batch\/v1\",\n  \"kind\": \"Job\",\n  \"metadata\": {\n    \"name\": \"oscar-django-migrations-@@{calm_application_uuid}@@\",\n    \"labels\": {\n      \"app\": \"django\",\n      \"component\": \"oscar\",\n      \"tier\": \"frontend\"\n    }\n  },\n  \"spec\": {\n    \"template\": {\n      \"metadata\": {\n        \"labels\": {\n          \"app\": \"django\",\n          \"component\": \"oscar\",\n          \"tier\": \"frontend\"\n        }\n      },\n      \"spec\": {\n        \"containers\": [\n          {\n            \"name\": \"django\",\n            \"image\": \"michaelatnutanix\/oscar_jet:latest\",\n            \"imagePullPolicy\": \"Always\",\n            \"command\": [\n              \"\/bin\/bash\",\n              \"migrate.sh\"\n            ],\n            \"env\": [\n              {\n                \"name\": \"DATABASE_USER\",\n                \"value\": \"postgres\"\n              },\n              {\n                \"name\": \"DATABASE_PASSWORD\",\n                \"value\": \"@@{db_password}@@\"\n              },\n              {\n                \"name\": \"DATABASE_HOST\",\n                \"value\": \"@@{Era.DB_SERVER_IP}@@\"\n              },\n              {\n                \"name\": \"DATABASE_NAME\",\n                \"value\": \"@@{Era.DB_NAME}@@\"\n              },\n              {\n                \"name\": \"ACCESS_KEY\",\n                \"value\": \"@@{buckets_creds.username}@@\"\n              },\n              {\n                \"name\": \"SECRET_ACCESS_KEY\",\n                \"value\": \"@@{buckets_creds.secret}@@\"\n              },\n              {\n                \"name\": \"STATIC_BUCKET\",\n                \"value\": \"@@{buckets_name}@@\"\n              },\n              {\n                \"name\": \"S3_ENDPOINT_URL\",\n                \"value\": \"http:\/\/@@{buckets_ip}@@:7200\/\"\n              }\n            ]\n          }\n        ],\n        \"restartPolicy\": \"Never\"\n      }\n    },\n    \"backoffLimit\": 5\n  }\n}\n\nkube_user = '@@{kube_creds.username}@@'\nkube_pass = '@@{kube_creds.secret}@@'\n\nresp = urlreq(url, verb='POST', auth='BASIC', user=kube_user, passwd=kube_pass, params=json.dumps(payload), headers=headers)\n\nprint json.dumps(json.loads(resp.content), indent=4)","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"CreateMigration","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Postgres"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"variable_list":[]},"type":"","uninstall_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"ee8bedbe_dag"},"message_list":[],"name":"faacff5d_runbook","state":"ACTIVE","task_definition_list":[{"attrs":{"command_line_args":"","exit_status":[],"script":"url     = \"https:\/\/@@{kubemaster_ip}@@:443\/apis\/batch\/v1\/namespaces\/@@{kube_namespace}@@\/jobs\/oscar-django-migrations-@@{calm_application_uuid}@@\"\nheaders = {'Content-Type': 'application\/json', 'Accept': 'application\/json'}\n\npayload = {}\n\nkube_user = '@@{kube_creds.username}@@'\nkube_pass = '@@{kube_creds.secret}@@'\n\nresp = urlreq(url, verb='DELETE', auth='BASIC', user=kube_user, passwd=kube_pass, params=json.dumps(payload), headers=headers)\n\nprint json.dumps(json.loads(resp.content), indent=4)","script_type":"static","type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"DeleteMigration","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_service","name":"Postgres"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[{"kind":"app_task","name":"DeleteMigration"}],"description":"","message_list":[],"name":"ee8bedbe_dag","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package2"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]}},"service_local_reference_list":[{"kind":"app_service","name":"Postgres"}],"type":"DEB","variable_list":[],"version":""},{"action_list":[],"description":"","image_spec":{"image":"michaelatnutanix\/oscar_jet:latest","imagePullPolicy":"Always"},"name":"Package3","service_local_reference_list":[{"kind":"app_service","name":"Django"}],"type":"K8S_IMAGE","variable_list":[],"version":""},{"action_list":[],"description":"","name":"Package4","options":{"install_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"9cec0ad1_dag"},"message_list":[],"name":"744e24d7_runbook","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"9cec0ad1_dag","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package4"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"","uninstall_runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"e2ef1489_dag"},"message_list":[],"name":"3e7995ae_runbook","state":"ACTIVE","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","message_list":[],"name":"e2ef1489_dag","retries":"0","state":"ACTIVE","target_any_local_reference":{"kind":"app_package","name":"Package4"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]}},"service_local_reference_list":[{"kind":"app_service","name":"Buckets"}],"type":"DEB","variable_list":[],"version":""}],"published_service_definition_list":[{"action_list":[],"depends_on_list":[],"description":"","name":"K8sPublishedService","options":{"metadata":{"labels":{"app":"django","component":"oscar","tier":"frontend"},"name":"oscar-django-service","namespace":"@@{kube_namespace}@@"},"spec":{"ports":[{"port":8000,"protocol":"TCP"}],"selector":{"app":"django"},"type":"NodePort"},"type":"PROVISION_K8S_SERVICE"},"port_list":[],"singleton":true,"tier":"","type":"K8S_SERVICE","variable_list":[]}],"service_definition_list":[{"action_list":[{"critical":false,"description":"System action for creating an application","name":"action_create","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"5aace26a_dag"},"name":"ce790098_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"5aace26a_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Buckets"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for deleting an application. Deletes created VMs as well","name":"action_delete","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"5a12a028_dag"},"name":"75076e9d_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"5a12a028_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Buckets"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for restarting an application","name":"action_restart","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"3007638a_dag"},"name":"92876d72_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"3007638a_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Buckets"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for starting an application","name":"action_start","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"d6ce3cfc_dag"},"name":"b72dde52_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"d6ce3cfc_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Buckets"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for stopping an application","name":"action_stop","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"e0befeaf_dag"},"name":"a45fb408_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"e0befeaf_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Buckets"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"}],"depends_on_list":[],"description":"","name":"Buckets","port_list":[],"singleton":false,"tier":"","variable_list":[]},{"action_list":[{"critical":false,"description":"System action for creating an application","name":"action_create","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"61a78ac6_dag"},"name":"dff28977_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"61a78ac6_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Django"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for deleting an application. Deletes created VMs as well","name":"action_delete","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"20625665_dag"},"name":"7947afce_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"20625665_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Django"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for restarting an application","name":"action_restart","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"f87f0346_dag"},"name":"c04dc25d_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"f87f0346_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Django"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for starting an application","name":"action_start","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"293e66a2_dag"},"name":"5d792569_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"293e66a2_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Django"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for stopping an application","name":"action_stop","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"b1e6f5a8_dag"},"name":"e8f603b7_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"b1e6f5a8_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Django"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"}],"container_spec":{"env":[{"name":"DATABASE_USER","value":"postgres"},{"name":"DATABASE_PASSWORD","value":"@@{db_password}@@"},{"name":"DATABASE_HOST","value":"@@{Era.DB_SERVER_IP}@@"},{"name":"DATABASE_NAME","value":"@@{Era.DB_NAME}@@"},{"name":"ACCESS_KEY","value":"@@{buckets_creds.username}@@"},{"name":"SECRET_ACCESS_KEY","value":"@@{buckets_creds.secret}@@"},{"name":"STATIC_BUCKET","value":"@@{buckets_name}@@"},{"name":"S3_ENDPOINT_URL","value":"http:\/\/@@{buckets_ip}@@:7200\/"},{"name":"DUMMY_HOST","value":"@@{Postgres.address}@@"}],"name":"oscar-django-329fe36","ports":[{"containerPort":8000}]},"depends_on_list":[{"kind":"app_service","name":"Buckets"},{"kind":"app_service","name":"Postgres"}],"description":"","name":"Django","port_list":[],"singleton":false,"tier":"","variable_list":[]},{"action_list":[{"critical":false,"description":"System action for creating an application","name":"action_create","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"0bfadcbf_dag"},"name":"975ed99a_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"0bfadcbf_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for deleting an application. Deletes created VMs as well","name":"action_delete","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"9ade3d68_dag"},"name":"cf884050_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"9ade3d68_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for restarting an application","name":"action_restart","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"1124d60e_dag"},"name":"6bcf94d3_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"1124d60e_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for starting an application","name":"action_start","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"0ae24e3c_dag"},"name":"84c12573_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"0ae24e3c_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for stopping an application","name":"action_stop","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"bf858e3b_dag"},"name":"6e2e5ff2_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"bf858e3b_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Era"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"}],"depends_on_list":[],"description":"","name":"Era","port_list":[],"singleton":false,"tier":"","variable_list":[{"attrs":{"type":""},"description":"","label":"","name":"CLEANUP_OPERATION_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"CLUSTER_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"COMPUTE_PROF_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"CREATE_OPERATION_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"DB_ENTITY_NAME","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"DB_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"DB_NAME","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"DB_PARAM_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"DB_SERVER_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"DB_SERVER_IP","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"DEREGISTER_OPERATION_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"NETWORK_PROF_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"SLA_ID","type":"LOCAL","val_type":"STRING","value":""},{"attrs":{"type":""},"description":"","label":"","name":"SOFTWARE_PROF_ID","type":"LOCAL","val_type":"STRING","value":""}]},{"action_list":[{"critical":false,"description":"System action for creating an application","name":"action_create","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"6fba9cbb_dag"},"name":"01945104_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"6fba9cbb_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Postgres"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for deleting an application. Deletes created VMs as well","name":"action_delete","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"8bee20f0_dag"},"name":"fe42eb38_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"8bee20f0_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Postgres"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for restarting an application","name":"action_restart","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"04cc6e24_dag"},"name":"ffd25064_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"04cc6e24_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Postgres"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for starting an application","name":"action_start","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"9d7e4dfb_dag"},"name":"ef6acd35_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"9d7e4dfb_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Postgres"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"},{"critical":false,"description":"System action for stopping an application","name":"action_stop","runbook":{"description":"","main_task_local_reference":{"kind":"app_task","name":"897e9b24_dag"},"name":"b81e8f8b_runbook","task_definition_list":[{"attrs":{"edges":[],"type":""},"child_tasks_local_reference_list":[],"description":"","name":"897e9b24_dag","retries":"0","target_any_local_reference":{"kind":"app_service","name":"Postgres"},"timeout_secs":"0","type":"DAG","variable_list":[]}],"variable_list":[]},"type":"system"}],"depends_on_list":[{"kind":"app_service","name":"Era"}],"description":"","name":"Postgres","port_list":[],"singleton":false,"tier":"","variable_list":[]}],"substrate_definition_list":[{"action_list":[],"create_spec":{"address":"@@{era_ip}@@","type":"PROVISION_EXISTING_MACHINE"},"description":"","name":"EraServer","os_type":"Linux","readiness_probe":{"address":"@@{ip_address}@@","connection_port":22,"connection_type":"SSH","delay_secs":"60","disable_readiness_probe":true,"login_credential_local_reference":{"kind":"app_credential","name":"era_creds"}},"type":"EXISTING_VM","variable_list":[]},{"action_list":[],"create_spec":{"address":"@@{Era.DB_SERVER_IP}@@","type":"PROVISION_EXISTING_MACHINE"},"description":"","name":"Era_PostgreSQL_DB","os_type":"Linux","readiness_probe":{"address":"@@{ip_address}@@","connection_port":22,"connection_type":"SSH","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"db_server_creds"}},"type":"EXISTING_VM","variable_list":[]},{"action_list":[],"create_spec":{"address":"@@{buckets_ip}@@","type":"PROVISION_EXISTING_MACHINE"},"description":"","name":"Object_Storage_Bucket","os_type":"Linux","readiness_probe":{"address":"@@{ip_address}@@","connection_port":22,"connection_type":"SSH","delay_secs":"60","disable_readiness_probe":true,"login_credential_local_reference":{"kind":"app_credential","name":"buckets_creds"}},"type":"EXISTING_VM","variable_list":[]},{"action_list":[],"create_spec":{"account_uuid":"83223736-3ed8-26be-2c5e-5cb7d0a84087","metadata":{"labels":{"app":"django","component":"oscar","tier":"frontend"},"name":"Oscar_Django","namespace":"@@{kube_namespace}@@"},"spec":{},"type":"PROVISION_K8S_POD"},"description":"","name":"Oscar","os_type":"Linux","readiness_probe":{"address":"","connection_port":22,"connection_type":"SSH","delay_secs":"60","disable_readiness_probe":false},"type":"K8S_POD","variable_list":[]}],"type":"USER"}},"status":{}}